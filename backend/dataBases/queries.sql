SELECT 
    r.ID_BREAKER as ID, 
    d.DEPARTMENT_CODE,
    r.TEMP AS LAST_TEMP, 
    SUM(r.KWH) AS CONSUMPTION,
    u.USERNAME AS PROPERTY,
    r.RECORD_DATE 
FROM RECORDS r
    JOIN BREAKERS    b ON b.ID = r.ID_BREAKER
    JOIN USERS       u ON u.ID = b.ID_USER
    JOIN DEPARTMENTS d ON d.ID = u.ID_DEPARTMENT
    WHERE r.RECORD_DATE = DATE('now', '-1 day');


-- first
-- SUM(r.KWH) AS CONSUMPTION,
-- WHERE r.RECORD_DATE BETWEEN DATE('now', '-15 day') AND DATE('now')
-- GROUP BY r.ID_BREAKER
-- ORDER BY r.RECORD_DATE DESC;

--second
-- SUM(r.KWH) AS CONSUMPTION,
-- SUM(r.KWH) AS CONSUMPTION,
-- GROUP BY r.ID_BREAKER;

-- third
-- GROUP BY r.ID_BREAKER
-- ORDER BY CONSUMPTION ASC

--fourth
-- SUM(r.KWH) AS CONSUMPTION,
-- WHERE r.RECORD_DATE = DATE('now', '-1 day');













-- INSERT INTO RECORDS (ID_BREAKER, KWH, TEMP, RECORD_DATE, KWH_AT_CT) VALUES ('6520fc0a00a365c22als9f', 946, 15, '2025-08-05 22:25:02', 1770);
-- INSERT INTO RECORDS (ID_BREAKER, KWH, TEMP, RECORD_DATE, KWH_AT_CT) VALUES ('6520fc0a00a365c22als9f', 1005, 15, '2025-08-06 22:25:02', 2775);
-- INSERT INTO RECORDS (ID_BREAKER, KWH, TEMP, RECORD_DATE, KWH_AT_CT) VALUES ('6520fc0a00a365c22als9f', 948, 15, '2025-08-07 22:25:02', 3723);
-- INSERT INTO RECORDS (ID_BREAKER, KWH, TEMP, RECORD_DATE, KWH_AT_CT) VALUES ('6520fc0a00a365c22als9f', 941, 15, '2025-08-08 22:25:02', 4664);
-- INSERT INTO RECORDS (ID_BREAKER, KWH, TEMP, RECORD_DATE, KWH_AT_CT) VALUES ('6520fc0a00a365c22als9f', 894, 15, '2025-08-09 22:25:02', 5558);
-- INSERT INTO RECORDS (ID_BREAKER, KWH, TEMP, RECORD_DATE, KWH_AT_CT) VALUES ('6520fc0a00a365c22als9f', 949, 15, '2025-08-10 22:25:02', 6507);
-- INSERT INTO RECORDS (ID_BREAKER, KWH, TEMP, RECORD_DATE, KWH_AT_CT) VALUES ('6520fc0a00a365c22als9f', 1052, 15, '2025-08-11 22:25:02', 7559);
-- INSERT INTO RECORDS (ID_BREAKER, KWH, TEMP, RECORD_DATE, KWH_AT_CT) VALUES ('6520fc0a00a365c22als9f', 1000, 15, '2025-08-12 22:25:02', 8559);
-- INSERT INTO RECORDS (ID_BREAKER, KWH, TEMP, RECORD_DATE, KWH_AT_CT) VALUES ('6520fc0a00a365c22als9f', 1046, 15, '2025-08-13 22:25:02', 9605);
-- INSERT INTO RECORDS (ID_BREAKER, KWH, TEMP, RECORD_DATE, KWH_AT_CT) VALUES ('6520fc0a00a365c22als9f', 985, 15, '2025-08-14 22:25:02', 10590);

-- INSERT INTO RECORDS (ID_BREAKER, KWH, TEMP, RECORD_DATE, KWH_AT_CT) VALUES ('65e6a732254c5669aceikp', 729, 24, '2025-08-05 22:25:02', 1234);
-- INSERT INTO RECORDS (ID_BREAKER, KWH, TEMP, RECORD_DATE, KWH_AT_CT) VALUES ('65e6a732254c5669aceikp', 759, 24, '2025-08-06 22:25:02', 1993);
-- INSERT INTO RECORDS (ID_BREAKER, KWH, TEMP, RECORD_DATE, KWH_AT_CT) VALUES ('65e6a732254c5669aceikp', 645, 24, '2025-08-07 22:25:02', 2638);
-- INSERT INTO RECORDS (ID_BREAKER, KWH, TEMP, RECORD_DATE, KWH_AT_CT) VALUES ('65e6a732254c5669aceikp', 639, 24, '2025-08-08 22:25:02', 3277);
-- INSERT INTO RECORDS (ID_BREAKER, KWH, TEMP, RECORD_DATE, KWH_AT_CT) VALUES ('65e6a732254c5669aceikp', 707, 24, '2025-08-09 22:25:02', 3984);
-- INSERT INTO RECORDS (ID_BREAKER, KWH, TEMP, RECORD_DATE, KWH_AT_CT) VALUES ('65e6a732254c5669aceikp', 781, 24, '2025-08-10 22:25:02', 4765);
-- INSERT INTO RECORDS (ID_BREAKER, KWH, TEMP, RECORD_DATE, KWH_AT_CT) VALUES ('65e6a732254c5669aceikp', 710, 24, '2025-08-11 22:25:02', 5475);
-- INSERT INTO RECORDS (ID_BREAKER, KWH, TEMP, RECORD_DATE, KWH_AT_CT) VALUES ('65e6a732254c5669aceikp', 624, 24, '2025-08-12 22:25:02', 6099);
-- INSERT INTO RECORDS (ID_BREAKER, KWH, TEMP, RECORD_DATE, KWH_AT_CT) VALUES ('65e6a732254c5669aceikp', 646, 24, '2025-08-13 22:25:02', 6745);
-- INSERT INTO RECORDS (ID_BREAKER, KWH, TEMP, RECORD_DATE, KWH_AT_CT) VALUES ('65e6a732254c5669aceikp', 685, 24, '2025-08-14 22:25:02', 7430);
